<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Data Model (Developer) &#8212; Zuspec Language  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=fd6eb6e6"></script>
    <script src="_static/sphinx_highlight.js?v=6ffebe34"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Zuspec IR Checker" href="checker.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="data-model-developer">
<h1>Data Model (Developer)<a class="headerlink" href="#data-model-developer" title="Link to this heading">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">zuspec.dataclasses.dm</span></code> module defines a type model for representing
Zuspec descriptions. This data model is used by tools that analyze, transform,
or generate code from Zuspec models.</p>
<section id="context">
<h2>Context<a class="headerlink" href="#context" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">Context</span></code> is the container for all type definitions in a data model.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">zuspec.dataclasses.dm</span><span class="w"> </span><span class="kn">import</span> <span class="n">Context</span>

<span class="n">ctx</span> <span class="o">=</span> <span class="n">Context</span><span class="p">()</span>
<span class="c1"># type_m maps qualified type names to DataType instances</span>
<span class="n">ctx</span><span class="o">.</span><span class="n">type_m</span><span class="p">[</span><span class="s2">&quot;MyModule.MyComponent&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_type</span>
</pre></div>
</div>
</section>
<section id="data-types">
<h2>Data Types<a class="headerlink" href="#data-types" title="Link to this heading">¶</a></h2>
<p>The data type hierarchy represents different kinds of types in Zuspec.</p>
<section id="datatype-base">
<h3>DataType (Base)<a class="headerlink" href="#datatype-base" title="Link to this heading">¶</a></h3>
<p>Base class for all data types.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DataType</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>      <span class="c1"># Qualified type name</span>
    <span class="n">py_type</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Any</span><span class="p">]</span>   <span class="c1"># Reference to original Python type</span>
</pre></div>
</div>
</section>
<section id="datatypeint">
<h3>DataTypeInt<a class="headerlink" href="#datatypeint" title="Link to this heading">¶</a></h3>
<p>Integer types with width and signedness.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DataTypeInt</span><span class="p">(</span><span class="n">DataType</span><span class="p">):</span>
    <span class="n">bits</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>      <span class="c1"># Bit width (-1 for default)</span>
    <span class="n">signed</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
</pre></div>
</div>
</section>
<section id="datatypestruct">
<h3>DataTypeStruct<a class="headerlink" href="#datatypestruct" title="Link to this heading">¶</a></h3>
<p>Pure-data types with fields and optional methods.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DataTypeStruct</span><span class="p">(</span><span class="n">DataType</span><span class="p">):</span>
    <span class="nb">super</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataType</span><span class="p">]</span>  <span class="c1"># Base type</span>
    <span class="n">fields</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Field</span><span class="p">]</span>        <span class="c1"># Field definitions</span>
    <span class="n">functions</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Function</span><span class="p">]</span>  <span class="c1"># Methods</span>
</pre></div>
</div>
</section>
<section id="datatypeclass">
<h3>DataTypeClass<a class="headerlink" href="#datatypeclass" title="Link to this heading">¶</a></h3>
<p>Polymorphic extension of struct (supports inheritance).</p>
</section>
<section id="datatypecomponent">
<h3>DataTypeComponent<a class="headerlink" href="#datatypecomponent" title="Link to this heading">¶</a></h3>
<p>Structural building blocks with ports, exports, and bindings.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DataTypeComponent</span><span class="p">(</span><span class="n">DataTypeClass</span><span class="p">):</span>
    <span class="n">bind_map</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Bind</span><span class="p">]</span>  <span class="c1"># Port/export connections</span>
</pre></div>
</div>
</section>
<section id="datatypeprotocol">
<h3>DataTypeProtocol<a class="headerlink" href="#datatypeprotocol" title="Link to this heading">¶</a></h3>
<p>Interface definitions (Python Protocol types).</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">DataTypeProtocol</span><span class="p">(</span><span class="n">DataType</span><span class="p">):</span>
    <span class="n">methods</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Function</span><span class="p">]</span>  <span class="c1"># Interface methods</span>
</pre></div>
</div>
</section>
<section id="other-data-types">
<h3>Other Data Types<a class="headerlink" href="#other-data-types" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">DataTypeString</span></code> - String type</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DataTypeEnum</span></code> - Enumeration type</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DataTypeLock</span></code> - Mutex lock type</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DataTypeMemory</span></code> - Memory storage type (with element_type, size)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DataTypeAddressSpace</span></code> - Address space type</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DataTypeAddrHandle</span></code> - Memory access handle</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DataTypeRef</span></code> - Forward reference to type by name</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DataTypeExpr</span></code> - Type defined by expression</p></li>
</ul>
</section>
</section>
<section id="fields">
<h2>Fields<a class="headerlink" href="#fields" title="Link to this heading">¶</a></h2>
<section id="field">
<h3>Field<a class="headerlink" href="#field" title="Link to this heading">¶</a></h3>
<p>Represents a field in a struct/class/component.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Field</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">datatype</span><span class="p">:</span> <span class="n">DataType</span>
    <span class="n">kind</span><span class="p">:</span> <span class="n">FieldKind</span> <span class="o">=</span> <span class="n">FieldKind</span><span class="o">.</span><span class="n">Field</span>
    <span class="n">bindset</span><span class="p">:</span> <span class="n">BindSet</span>
</pre></div>
</div>
</section>
<section id="fieldkind">
<h3>FieldKind<a class="headerlink" href="#fieldkind" title="Link to this heading">¶</a></h3>
<p>Enumeration of field kinds:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">FieldKind.Field</span></code> - Regular data field</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FieldKind.Port</span></code> - API consumer (requires binding)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FieldKind.Export</span></code> - API provider</p></li>
</ul>
</section>
<section id="fieldinout">
<h3>FieldInOut<a class="headerlink" href="#fieldinout" title="Link to this heading">¶</a></h3>
<p>Input/output field with direction.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">FieldInOut</span><span class="p">(</span><span class="n">Field</span><span class="p">):</span>
    <span class="n">is_out</span><span class="p">:</span> <span class="nb">bool</span>  <span class="c1"># True for output, False for input</span>
</pre></div>
</div>
</section>
</section>
<section id="bindings">
<h2>Bindings<a class="headerlink" href="#bindings" title="Link to this heading">¶</a></h2>
<section id="bind">
<h3>Bind<a class="headerlink" href="#bind" title="Link to this heading">¶</a></h3>
<p>Single binding between two expressions.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Bind</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">lhs</span><span class="p">:</span> <span class="n">Expr</span>  <span class="c1"># Target (port, export method)</span>
    <span class="n">rhs</span><span class="p">:</span> <span class="n">Expr</span>  <span class="c1"># Source (export, method)</span>
</pre></div>
</div>
</section>
<section id="bindset">
<h3>BindSet<a class="headerlink" href="#bindset" title="Link to this heading">¶</a></h3>
<p>Collection of bindings for a field.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">BindSet</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">binds</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Bind</span><span class="p">]</span>
</pre></div>
</div>
</section>
</section>
<section id="expressions">
<h2>Expressions<a class="headerlink" href="#expressions" title="Link to this heading">¶</a></h2>
<p>Expression types represent values and references in the data model.</p>
<section id="core-expression-types">
<h3>Core Expression Types<a class="headerlink" href="#core-expression-types" title="Link to this heading">¶</a></h3>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">Expr</span></code></dt><dd><p>Base class for all expressions.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ExprConstant</span></code></dt><dd><p>Literal value.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ExprConstant</span><span class="p">(</span><span class="n">Expr</span><span class="p">):</span>
    <span class="n">value</span><span class="p">:</span> <span class="nb">object</span>
    <span class="n">kind</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span>  <span class="c1"># Type hint</span>
</pre></div>
</div>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ExprBin</span></code></dt><dd><p>Binary operation.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ExprBin</span><span class="p">(</span><span class="n">Expr</span><span class="p">):</span>
    <span class="n">lhs</span><span class="p">:</span> <span class="n">Expr</span>
    <span class="n">op</span><span class="p">:</span> <span class="n">BinOp</span>
    <span class="n">rhs</span><span class="p">:</span> <span class="n">Expr</span>
</pre></div>
</div>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ExprUnary</span></code></dt><dd><p>Unary operation.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ExprBool</span></code></dt><dd><p>Boolean operation (and/or) with multiple values.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ExprCompare</span></code></dt><dd><p>Comparison with chained operators.</p>
</dd>
</dl>
</section>
<section id="reference-expressions">
<h3>Reference Expressions<a class="headerlink" href="#reference-expressions" title="Link to this heading">¶</a></h3>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">ExprRef</span></code></dt><dd><p>Base for reference expressions.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">TypeExprRefSelf</span></code></dt><dd><p>Reference to <code class="docutils literal notranslate"><span class="pre">self</span></code>.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ExprRefField</span></code></dt><dd><p>Reference to a field relative to base expression.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ExprRefField</span><span class="p">(</span><span class="n">ExprRef</span><span class="p">):</span>
    <span class="n">base</span><span class="p">:</span> <span class="n">Expr</span>   <span class="c1"># Base expression (e.g., TypeExprRefSelf)</span>
    <span class="n">index</span><span class="p">:</span> <span class="nb">int</span>   <span class="c1"># Field index</span>
</pre></div>
</div>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ExprRefPy</span></code></dt><dd><p>Reference to a Python attribute.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ExprRefPy</span><span class="p">(</span><span class="n">ExprRef</span><span class="p">):</span>
    <span class="n">base</span><span class="p">:</span> <span class="n">Expr</span>
    <span class="n">ref</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># Attribute name</span>
</pre></div>
</div>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ExprRefBottomUp</span></code></dt><dd><p>Reference relative to procedural scope.</p>
</dd>
</dl>
</section>
<section id="access-expressions">
<h3>Access Expressions<a class="headerlink" href="#access-expressions" title="Link to this heading">¶</a></h3>
<dl>
<dt><code class="docutils literal notranslate"><span class="pre">ExprAttribute</span></code></dt><dd><p>Attribute access (<code class="docutils literal notranslate"><span class="pre">obj.attr</span></code>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ExprSubscript</span></code></dt><dd><p>Subscript access (<code class="docutils literal notranslate"><span class="pre">obj[key]</span></code>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ExprSlice</span></code></dt><dd><p>Slice specification (<code class="docutils literal notranslate"><span class="pre">lower:upper:step</span></code>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">ExprCall</span></code></dt><dd><p>Function/method call.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">ExprCall</span><span class="p">(</span><span class="n">Expr</span><span class="p">):</span>
    <span class="n">func</span><span class="p">:</span> <span class="n">Expr</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Expr</span><span class="p">]</span>
    <span class="n">keywords</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Keyword</span><span class="p">]</span>
</pre></div>
</div>
</dd>
</dl>
</section>
<section id="operators">
<h3>Operators<a class="headerlink" href="#operators" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">BinOp</span></code></dt><dd><p>Binary operators: Add, Sub, Mult, Div, Mod, BitAnd, BitOr, BitXor,
LShift, RShift, Eq, NotEq, Lt, LtE, Gt, GtE, And, Or</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">UnaryOp</span></code></dt><dd><p>Unary operators: Invert, Not, UAdd, USub</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">BoolOp</span></code></dt><dd><p>Boolean operators: And, Or</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">CmpOp</span></code></dt><dd><p>Comparison operators: Eq, NotEq, Lt, LtE, Gt, GtE, Is, IsNot, In, NotIn</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">AugOp</span></code></dt><dd><p>Augmented assignment operators: Add, Sub, Mult, Div, Mod, Pow,
LShift, RShift, BitAnd, BitOr, BitXor, FloorDiv</p>
</dd>
</dl>
</section>
<section id="extended-expressions">
<h3>Extended Expressions<a class="headerlink" href="#extended-expressions" title="Link to this heading">¶</a></h3>
<p>From <code class="docutils literal notranslate"><span class="pre">expr_phase2.py</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ExprList</span></code>, <code class="docutils literal notranslate"><span class="pre">ExprTuple</span></code>, <code class="docutils literal notranslate"><span class="pre">ExprDict</span></code>, <code class="docutils literal notranslate"><span class="pre">ExprSet</span></code> - Collection literals</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ExprListComp</span></code>, <code class="docutils literal notranslate"><span class="pre">ExprDictComp</span></code>, <code class="docutils literal notranslate"><span class="pre">ExprSetComp</span></code> - Comprehensions</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ExprGeneratorExp</span></code> - Generator expression</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ExprIfExp</span></code> - Conditional expression (ternary)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ExprLambda</span></code> - Lambda expression</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ExprNamedExpr</span></code> - Walrus operator (<code class="docutils literal notranslate"><span class="pre">:=</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ExprJoinedStr</span></code>, <code class="docutils literal notranslate"><span class="pre">ExprFormattedValue</span></code> - F-string support</p></li>
</ul>
</section>
</section>
<section id="statements">
<h2>Statements<a class="headerlink" href="#statements" title="Link to this heading">¶</a></h2>
<p>Statement types represent executable code in the data model.</p>
<section id="core-statements">
<h3>Core Statements<a class="headerlink" href="#core-statements" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">Stmt</span></code></dt><dd><p>Base class for statements.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StmtExpr</span></code></dt><dd><p>Expression statement.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StmtAssign</span></code></dt><dd><p>Assignment (<code class="docutils literal notranslate"><span class="pre">targets</span> <span class="pre">=</span> <span class="pre">value</span></code>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StmtAugAssign</span></code></dt><dd><p>Augmented assignment (<code class="docutils literal notranslate"><span class="pre">target</span> <span class="pre">+=</span> <span class="pre">value</span></code>).</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StmtReturn</span></code></dt><dd><p>Return statement.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StmtPass</span></code></dt><dd><p>Pass statement.</p>
</dd>
</dl>
</section>
<section id="control-flow">
<h3>Control Flow<a class="headerlink" href="#control-flow" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">StmtIf</span></code></dt><dd><p>Conditional with test, body, and orelse.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StmtFor</span></code></dt><dd><p>For loop with target, iter, body, and orelse.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StmtWhile</span></code></dt><dd><p>While loop.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StmtBreak</span></code>, <code class="docutils literal notranslate"><span class="pre">StmtContinue</span></code></dt><dd><p>Loop control.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StmtMatch</span></code>, <code class="docutils literal notranslate"><span class="pre">StmtMatchCase</span></code></dt><dd><p>Pattern matching (Python 3.10+).</p>
</dd>
</dl>
</section>
<section id="exception-handling">
<h3>Exception Handling<a class="headerlink" href="#exception-handling" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">StmtRaise</span></code></dt><dd><p>Raise exception.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StmtAssert</span></code></dt><dd><p>Assertion.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StmtTry</span></code>, <code class="docutils literal notranslate"><span class="pre">StmtExceptHandler</span></code></dt><dd><p>Try/except blocks.</p>
</dd>
<dt><code class="docutils literal notranslate"><span class="pre">StmtWith</span></code>, <code class="docutils literal notranslate"><span class="pre">WithItem</span></code></dt><dd><p>Context manager.</p>
</dd>
</dl>
</section>
</section>
<section id="functions-methods">
<h2>Functions &amp; Methods<a class="headerlink" href="#functions-methods" title="Link to this heading">¶</a></h2>
<section id="function">
<h3>Function<a class="headerlink" href="#function" title="Link to this heading">¶</a></h3>
<p>Represents a method or standalone function.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Function</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">Arguments</span>
    <span class="n">body</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Stmt</span><span class="p">]</span>
    <span class="n">returns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">DataType</span><span class="p">]</span>
    <span class="n">is_async</span><span class="p">:</span> <span class="nb">bool</span>
</pre></div>
</div>
</section>
<section id="process">
<h3>Process<a class="headerlink" href="#process" title="Link to this heading">¶</a></h3>
<p>Represents a <code class="docutils literal notranslate"><span class="pre">&#64;process</span></code> decorated method.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Process</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">name</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">body</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Stmt</span><span class="p">]</span>
</pre></div>
</div>
</section>
<section id="arguments">
<h3>Arguments<a class="headerlink" href="#arguments" title="Link to this heading">¶</a></h3>
<p>Function argument specification.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Arguments</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">args</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Arg</span><span class="p">]</span>
    <span class="c1"># Plus: posonlyargs, kwonlyargs, vararg, kwarg, defaults, kw_defaults</span>
</pre></div>
</div>
</section>
<section id="arg">
<h3>Arg<a class="headerlink" href="#arg" title="Link to this heading">¶</a></h3>
<p>Single argument.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">Arg</span><span class="p">(</span><span class="n">Base</span><span class="p">):</span>
    <span class="n">arg</span><span class="p">:</span> <span class="nb">str</span>                    <span class="c1"># Argument name</span>
    <span class="n">annotation</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Expr</span><span class="p">]</span>  <span class="c1"># Type annotation</span>
</pre></div>
</div>
</section>
</section>
<section id="visitor">
<h2>Visitor<a class="headerlink" href="#visitor" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Visitor</span></code> class provides the visitor pattern for traversing data models.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">zuspec.dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dm</span>

<span class="nd">@dm</span><span class="o">.</span><span class="n">visitor</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MyVisitor</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">Visitor</span><span class="p">):</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">visitDataTypeComponent</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">dm</span><span class="o">.</span><span class="n">DataTypeComponent</span><span class="p">):</span>
        <span class="c1"># Process component type</span>
        <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">obj</span><span class="o">.</span><span class="n">fields</span><span class="p">:</span>
            <span class="n">field</span><span class="o">.</span><span class="n">accept</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">visitField</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="n">dm</span><span class="o">.</span><span class="n">Field</span><span class="p">):</span>
        <span class="c1"># Process field</span>
        <span class="k">pass</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">&#64;dm.visitor(pmod)</span></code> decorator builds visitor method dispatch based
on the profile registry. Unimplemented visit methods default to <code class="docutils literal notranslate"><span class="pre">visitBase</span></code>.</p>
</section>
<section id="jsonconverter">
<h2>JsonConverter<a class="headerlink" href="#jsonconverter" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">JsonConverter</span></code> provides serialization support for data models.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">zuspec.dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dm</span>

<span class="nd">@dm</span><span class="o">.</span><span class="n">json_converter</span><span class="p">(</span><span class="vm">__name__</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MyConverter</span><span class="p">(</span><span class="n">dm</span><span class="o">.</span><span class="n">JsonConverter</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
</section>
<section id="datamodelfactory">
<h2>DataModelFactory<a class="headerlink" href="#datamodelfactory" title="Link to this heading">¶</a></h2>
<p><code class="docutils literal notranslate"><span class="pre">DataModelFactory</span></code> converts Python Zuspec types into data model representations.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">zuspec.dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">DataModelFactory</span>

<span class="n">factory</span> <span class="o">=</span> <span class="n">DataModelFactory</span><span class="p">()</span>
<span class="n">context</span> <span class="o">=</span> <span class="n">factory</span><span class="o">.</span><span class="n">build</span><span class="p">([</span><span class="n">MyComponent</span><span class="p">,</span> <span class="n">MyProtocol</span><span class="p">])</span>

<span class="c1"># Access type definitions</span>
<span class="n">comp_type</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">type_m</span><span class="p">[</span><span class="s2">&quot;MyComponent&quot;</span><span class="p">]</span>
</pre></div>
</div>
<section id="key-methods">
<h3>Key Methods<a class="headerlink" href="#key-methods" title="Link to this heading">¶</a></h3>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">build(types)</span> <span class="pre">-&gt;</span> <span class="pre">Context</span></code></dt><dd><p>Build a Context containing data models for the given types.
Handles single types or iterables.</p>
</dd>
</dl>
</section>
<section id="internal-processing">
<h3>Internal Processing<a class="headerlink" href="#internal-processing" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">_process_type(t)</span></code> - Dispatch to appropriate type processor</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_process_component(t)</span></code> - Create DataTypeComponent</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_process_protocol(t)</span></code> - Create DataTypeProtocol</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_process_dataclass(t)</span></code> - Create DataTypeStruct</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_extract_fields(t)</span></code> - Extract Field list from dataclass</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_extract_bind_map(t)</span></code> - Evaluate <code class="docutils literal notranslate"><span class="pre">__bind__</span></code> to capture bindings</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">_extract_method_body(cls,</span> <span class="pre">name)</span></code> - Parse method AST to statements</p></li>
</ul>
</section>
<section id="bind-map-extraction">
<h3>Bind Map Extraction<a class="headerlink" href="#bind-map-extraction" title="Link to this heading">¶</a></h3>
<p>The factory uses proxy objects to evaluate <code class="docutils literal notranslate"><span class="pre">__bind__</span></code> methods:</p>
<ol class="arabic simple">
<li><p>Create <code class="docutils literal notranslate"><span class="pre">_BindProxy</span></code> with field indices and types</p></li>
<li><p>Call <code class="docutils literal notranslate"><span class="pre">__bind__(proxy)</span></code> to get binding dict</p></li>
<li><p>Convert proxy paths to <code class="docutils literal notranslate"><span class="pre">ExprRefField</span></code> expressions</p></li>
<li><p>Build <code class="docutils literal notranslate"><span class="pre">Bind</span></code> entries for each mapping</p></li>
</ol>
</section>
</section>
<section id="profile-system">
<h2>Profile System<a class="headerlink" href="#profile-system" title="Link to this heading">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">dm</span></code> module uses a profile system for extensibility.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">zuspec.dataclasses</span><span class="w"> </span><span class="kn">import</span> <span class="n">dm</span>

<span class="c1"># Register a profile (extends base dm)</span>
<span class="n">dm</span><span class="o">.</span><span class="n">profile</span><span class="p">(</span><span class="vm">__name__</span><span class="p">,</span> <span class="nb">super</span><span class="o">=</span><span class="s2">&quot;zuspec.dataclasses.dm&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Profiles track which data model classes exist, enabling the Visitor
to generate appropriate dispatch methods.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Zuspec Language</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">User Guide:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Zuspec Language Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="abstraction_levels.html">Abstraction Levels</a></li>
<li class="toctree-l1"><a class="reference internal" href="components.html">Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="fields.html">Class Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="types.html">Core Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="runtime.html">Runtime Implementation (Developer)</a></li>
<li class="toctree-l1"><a class="reference internal" href="checker.html">Zuspec IR Checker</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Topics:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Data Model (Developer)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#context">Context</a></li>
<li class="toctree-l2"><a class="reference internal" href="#data-types">Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fields">Fields</a></li>
<li class="toctree-l2"><a class="reference internal" href="#bindings">Bindings</a></li>
<li class="toctree-l2"><a class="reference internal" href="#expressions">Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#statements">Statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#functions-methods">Functions &amp; Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="#visitor">Visitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#jsonconverter">JsonConverter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#datamodelfactory">DataModelFactory</a></li>
<li class="toctree-l2"><a class="reference internal" href="#profile-system">Profile System</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="checker.html" title="previous chapter">Zuspec IR Checker</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2022-2026, Matthew Ballance.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 9.1.0</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/datamodel.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>