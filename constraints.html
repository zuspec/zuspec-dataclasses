<!DOCTYPE html>

<html lang="en" data-content_root="./">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Constraints &#8212; Zuspec Language  documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=5ecbeea2" />
    <link rel="stylesheet" type="text/css" href="_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css?v=27fed22d" />
    <script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Dependencies" href="dependencies.html" />
    <link rel="prev" title="Actions" href="actions.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  

  
  

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="constraints">
<h1>Constraints<a class="headerlink" href="#constraints" title="Link to this heading">¶</a></h1>
<p>Constraints may be used in many places within a <cite>Zuspec</cite> description
to relate the values of random variables. Constraint methods are
regular Python methods where all statements are treated as boolean
statements an applied concurrently. In other words, there is no
procedural order in which the statements are evaluated. All must
hold ‘True’.</p>
<section id="constraint-blocks">
<h2>Constraint Blocks<a class="headerlink" href="#constraint-blocks" title="Link to this heading">¶</a></h2>
<p>Constraint blocks are methods decorated with the <cite>constraint</cite>
decorator. They are legal in randomizable <cite>Zuspec</cite> contexts,
such as Struct, Action, and Component.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">zuspec.dataclasses</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">zdc</span>

<span class="nd">@zdc</span><span class="o">.</span><span class="n">dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MyS</span><span class="p">(</span><span class="n">zdc</span><span class="o">.</span><span class="n">Struct</span><span class="p">):</span>
  <span class="n">a</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">zdc</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">rand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">b</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">zdc</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">rand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

  <span class="nd">@zdc</span><span class="o">.</span><span class="n">constraint</span>
  <span class="k">def</span><span class="w"> </span><span class="nf">ab_c</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">&lt;</span> <span class="mi">10</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>
</pre></div>
</div>
<p>Constraint blocks always apply when the containing scope is randomized.</p>
</section>
<section id="constraint-functions">
<h2>Constraint Functions<a class="headerlink" href="#constraint-functions" title="Link to this heading">¶</a></h2>
<p>Constraint methods are reusable constraints that only apply once they
have been referenced.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">zuspec.dataclasses</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">zdc</span>

<span class="nd">@zdc</span><span class="o">.</span><span class="n">constraint</span>
<span class="k">def</span><span class="w"> </span><span class="nf">max</span><span class="p">(</span><span class="n">rv</span><span class="p">,</span> <span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">):</span>
    <span class="n">rv</span> <span class="o">==</span> <span class="n">v1</span> <span class="k">if</span> <span class="n">v1</span> <span class="o">&gt;</span> <span class="n">v2</span> <span class="k">else</span> <span class="n">v2</span>

<span class="nd">@zdc</span><span class="o">.</span><span class="n">dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">MyS</span><span class="p">(</span><span class="n">zdc</span><span class="o">.</span><span class="n">Struct</span><span class="p">):</span>
  <span class="n">a</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">zdc</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">rand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">b</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">zdc</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">rand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">c</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">zdc</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">rand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

  <span class="nd">@zdc</span><span class="o">.</span><span class="n">constraint</span>
  <span class="k">def</span><span class="w"> </span><span class="nf">ab_c</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">&gt;</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span> <span class="o">==</span> <span class="mi">5</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">a_range_small</span><span class="p">()</span>

    <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">b</span><span class="p">)</span>

  <span class="nd">@zdc</span><span class="o">.</span><span class="n">constraint</span><span class="p">(</span><span class="n">fn</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="k">def</span><span class="w"> </span><span class="nf">a_range_small</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="n">i</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
</pre></div>
</div>
<p>In the example above, <cite>max</cite> is defined as a standalone constraint function.
The <cite>constraint</cite> decorator determines this based on the presence of
parameters to the function. A constraint function is considered to have
a boolean result which is the logical <cite>and</cite> of all statements within.</p>
<p>The <cite>max</cite> constraint above equates the three variables to ensure that
the result variable takes the maximum value of the two inputs. Activating
the constraint is done by referencing it within a constraint. It is
illegal to call a constraint function in procedural code.</p>
<p>The <cite>a_range_small</cite> method is also a constraint function. Because this
function acts on class variables and has no additional parameters, we
explicitly mark the constraint as being a function (fn=True).</p>
</section>
<section id="constraint-statements">
<h2>Constraint Statements<a class="headerlink" href="#constraint-statements" title="Link to this heading">¶</a></h2>
<p>All constraint statements follow Python syntax, but are interpreted
as boolean statements instead of procedural statements.</p>
<section id="boolean-expressions">
<h3>Boolean Expressions<a class="headerlink" href="#boolean-expressions" title="Link to this heading">¶</a></h3>
<section id="in-operator">
<h4><strong>in</strong> Operator<a class="headerlink" href="#in-operator" title="Link to this heading">¶</a></h4>
<p>The <cite>in</cite> operator may be used in constraint expressions. The rhs
expression must be an iterable, and may include:</p>
<ul class="simple">
<li><p><strong>range</strong> function</p></li>
<li><p>a generator function</p></li>
<li><p>a list or tuple</p></li>
</ul>
<p>The iterable must be “pure”, in the sense that it always returns
the same set given the same inputs.</p>
<div class="highlight-python3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">zuspec.dataclasses</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">zdc</span>

<span class="k">class</span><span class="w"> </span><span class="nc">MyS</span><span class="p">(</span><span class="n">zdc</span><span class="o">.</span><span class="n">Struct</span><span class="p">):</span>
    <span class="n">a</span> <span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">zdc</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="n">rand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@zdc</span><span class="o">.</span><span class="n">constraint</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_a_c</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span> <span class="c1"># a in 0..9</span>
</pre></div>
</div>
</section>
</section>
<section id="for">
<h3>For<a class="headerlink" href="#for" title="Link to this heading">¶</a></h3>
<ul class="simple">
<li><p>enumerate() support</p></li>
</ul>
</section>
<section id="if-else">
<h3>If/Else<a class="headerlink" href="#if-else" title="Link to this heading">¶</a></h3>
</section>
<section id="match">
<h3>Match<a class="headerlink" href="#match" title="Link to this heading">¶</a></h3>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Zuspec Language</a></h1>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Zuspec Language Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="datatypes.html">Data Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="fields.html">Class Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="struct.html">Struct Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="components.html">Components</a></li>
<li class="toctree-l1"><a class="reference internal" href="actions.html">Actions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Constraints</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#constraint-blocks">Constraint Blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#constraint-functions">Constraint Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#constraint-statements">Constraint Statements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dependencies.html">Dependencies</a></li>
<li class="toctree-l1"><a class="reference internal" href="profiles.html">Profiles</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="actions.html" title="previous chapter">Actions</a></li>
      <li>Next: <a href="dependencies.html" title="next chapter">Dependencies</a></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2025, Matthew Ballance.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="_sources/constraints.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>